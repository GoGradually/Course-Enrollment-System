# 대학교 수강신청 시스템 구현 체크리스트

본 문서는 `docs/프로젝트 요구사항 문서화/프로젝트 요구사항 구성.md`를 구현 가능한 작업 단위로 분해한 체크리스트입니다.

## 공통 규칙

- [ ] 모든 작업 항목은 아래 템플릿을 채워 완료 처리한다.
  - 우선순위: `P0`(필수) / `P1`(권장) / `P2`(선택)
  - 작업: 구현 또는 문서화 내용
  - 완료 기준(DoD): 객관적으로 확인 가능한 조건
  - 리스크: 실패 가능성, 불명확 요구사항, 품질 저하 요소
  - 대응: 리스크 완화 방법
  - 검증: 커맨드, API 호출, 테스트 명

## A. 초기 부트스트랩

- [x] A1. Gradle/Spring 기본 빌드 정상화
  - 우선순위: `P0`
  - 작업: Java 21 + Spring Boot 3 기준으로 플러그인/의존성 조정, 컴파일 및 테스트 실행 가능 상태 확보
  - 완료 기준(DoD):
    - `./gradlew clean build` 성공
    - 애플리케이션 부팅 시 치명적 예외 없음
  - 리스크: 잘못된 스타터 의존성으로 런타임 오류 발생
  - 대응: 공식 starter(`spring-boot-starter-web`, `spring-boot-starter-data-jpa`, `springdoc`) 기준으로 정리
  - 검증:
    - `./gradlew clean build` 성공 (`BUILD SUCCESSFUL`)
    - `./gradlew bootRun`으로 부팅 로그에서 치명적 예외 없음 확인

- [x] A2. 레이어 패키지 골격 구성
  - 우선순위: `P0`
  - 작업: `domain`, `application`, `interfaces`, `infrastructure` 패키지 구조 생성
  - 완료 기준(DoD):
    - 각 레이어 최소 1개 클래스 존재(예: placeholder 또는 기본 서비스)
    - 의존 방향이 `interfaces -> application -> domain`으로 유지됨
  - 리스크: 레이어 간 순환 의존성
  - 대응: 도메인에서 인프라/웹 의존 금지, 포트/어댑터 구조 유지
  - 검증:
    - 레이어 골격 클래스 생성 확인:
      - `.../domain/health/HealthStatus.java`
      - `.../application/health/HealthQueryService.java`
      - `.../interfaces/web/HealthController.java`
      - `.../infrastructure/config/BootstrapConfig.java`
    - `LayerDependencyTest`(ArchUnit) 통과로 의존 방향 검증

- [x] A3. 헬스체크 엔드포인트 구현
  - 우선순위: `P0`
  - 작업: `GET /health` 엔드포인트 구현
  - 완료 기준(DoD):
    - `GET /health`가 HTTP `200` 반환
    - 서버 시작 후 즉시 호출 가능
  - 리스크: 초기 데이터 생성이 늦어 응답 지연
  - 대응: 데이터 초기화를 애플리케이션 시작 흐름에서 안정적으로 처리
  - 검증:
    - `HealthControllerTest` 통과 (`GET /health` -> `200`, `{"status":"UP"}`)
    - `curl -i http://localhost:8080/health` 실호출 결과 `HTTP/1.1 200`, body `{"status":"UP"}`

## B. 도메인 모델링 및 비즈니스 규칙

- [x] B1. 핵심 엔티티/값 객체 정의
  - 우선순위: `P0`
  - 작업: `Department`, `Professor`, `Student`, `Course`, `Enrollment`, `TimeSlot`(또는 동등 VO) 모델링
  - 완료 기준(DoD):
    - 엔티티 간 관계와 식별자 정책이 코드에 반영됨
    - 수강신청 가능 여부 판단에 필요한 필드(학점, 정원, 시간표) 포함
  - 리스크: 시간표/학점 모델이 모호해 규칙 누락
  - 대응: 필수 불변식(정원, 학점, 시간 충돌)을 도메인 메서드로 캡슐화
  - 검증:
    - `CourseTest`, `StudentTest`, `EnrollmentTest` 통과
    - `./gradlew test --tests '*domain*'` 성공

- [x] B2. 수강신청 비즈니스 규칙 구현
  - 우선순위: `P0`
  - 작업: 신청 시 아래 규칙 검증
    - 정원 초과 금지
    - 학생 최대 18학점 제한
    - 시간표 충돌 금지
    - 동일 강좌 중복 신청 금지
  - 완료 기준(DoD):
    - 규칙 위반 시 타입화된 도메인 예외 발생
    - 정상 케이스에서만 신청 성공
  - 리스크: 체크 순서/경합 상태에 따라 오판정
  - 대응: 트랜잭션 경계 내부에서 최종 검증 수행
  - 검증:
    - `EnrollmentApplicationServiceTest`의 신청 규칙 테스트 통과
      - `shouldRejectDuplicateEnrollment`
      - `shouldRejectWhenCreditLimitExceeded`
      - `shouldRejectWhenScheduleConflicts`
      - `shouldRejectWhenCourseCapacityExceeded`

- [x] B3. 수강취소 비즈니스 규칙 구현
  - 우선순위: `P0`
  - 작업: 수강취소 시 신청 상태, 정원/인원, 학점 반영
  - 완료 기준(DoD):
    - 취소 후 동일 학생의 학점이 정확히 감소
    - 취소된 강좌는 재신청 가능
  - 리스크: 취소 중복 호출로 데이터 불일치
  - 대응: idempotent 처리 정책 정의 또는 명확한 예외 반환
  - 검증:
    - `EnrollmentApplicationServiceTest#shouldCancelEnrollmentAndDecreaseCourseCount`
    - `EnrollmentApplicationServiceIntegrationTest#shouldAllowReEnrollmentAfterCancellation`

## C. REST API 구현

- [ ] C1. 학생 목록 조회 API 구현
  - 우선순위: `P0`
  - 작업: `GET /students` 구현(페이지네이션 또는 제한 파라미터 포함)
  - 완료 기준(DoD):
    - 유효한 학생 목록 반환
    - 테스트 시 학생 ID 확인 가능
  - 리스크: 대량 데이터 전체 조회 시 응답 지연
  - 대응: 기본 페이지 크기 지정, 정렬 기준 고정
  - 검증: API 호출 + 응답 스키마 검증

- [ ] C2. 교수 목록 조회 API 구현
  - 우선순위: `P0`
  - 작업: `GET /professors` 구현
  - 완료 기준(DoD):
    - 교수 목록/ID 조회 가능
  - 리스크: N+1 조회 문제
  - 대응: 조회 전용 DTO/페치 전략 적용
  - 검증: API 호출 + SQL 로그 점검

- [ ] C3. 강좌 목록 조회 API 구현(전체/학과별)
  - 우선순위: `P0`
  - 작업: `GET /courses`, `departmentId` 필터 지원
  - 완료 기준(DoD):
    - 응답에 필수 필드 포함: `id`, `name`, `credits`, `capacity`, `enrolled`, `schedule`
    - 학과 필터 정상 동작
  - 리스크: `enrolled` 집계 부정확
  - 대응: 집계 쿼리 또는 동기화 가능한 카운트 정책 채택
  - 검증: 필터 유/무 API 테스트

- [ ] C4. 수강신청 API 구현
  - 우선순위: `P0`
  - 작업: `POST /enrollments` 구현(`studentId`, `courseId`)
  - 완료 기준(DoD):
    - 성공 시 생성 결과 반환(예: enrollmentId, 상태)
    - 규칙 위반 시 표준 에러 응답 반환
  - 리스크: 동시 요청에서 중복/초과 승인
  - 대응: 동시성 제어 + DB 제약조건(유니크) 병행
  - 검증: 단건/동시 요청 테스트

- [ ] C5. 수강취소 API 구현
  - 우선순위: `P0`
  - 작업: `DELETE /enrollments/{enrollmentId}` 또는 동등 인터페이스 구현
  - 완료 기준(DoD):
    - 존재하는 신청건 취소 성공
    - 없는 신청건은 정의된 에러 응답
  - 리스크: 학생-신청건 소유권 검증 누락
  - 대응: 요청 파라미터에 학생 식별 포함 또는 서버 검증 로직 추가
  - 검증: 정상/오류 케이스 API 테스트

- [ ] C6. 내 시간표 조회 API 구현
  - 우선순위: `P0`
  - 작업: `GET /students/{studentId}/timetable` 구현(이번 학기 기준)
  - 완료 기준(DoD):
    - 신청된 강좌 시간표를 충돌 없이 조회 가능
    - 학점 합계(선택) 또는 강좌 정보 포함
  - 리스크: 이번 학기 기준 모호
  - 대응: 과제 범위에서 단일 학기로 고정하고 문서 명시
  - 검증: 샘플 학생 조회 테스트

- [ ] C7. 에러 응답 표준화
  - 우선순위: `P0`
  - 작업: 공통 예외 처리기 구현(`code`, `message`, `timestamp` 등)
  - 완료 기준(DoD):
    - 비즈니스/검증/시스템 예외가 일관된 포맷으로 반환
    - 주요 상태코드 정의(`400`, `404`, `409`, `422`, `500`)
  - 리스크: 예외 누락으로 기본 HTML 오류 반환
  - 대응: 글로벌 예외 핸들러 + 테스트 추가
  - 검증: 실패 케이스 API 테스트

## D. 동시성 제어

- [x] D1. 좌석 경쟁 시나리오 보호 전략 적용
  - 우선순위: `P0`
  - 트랜잭션 격리 수준
    - READ COMMITTED 고정
    - 추후 별개의 트랜잭션 격리 수준을 적용한 성능 테스트용 API 추가 가능
  - 작업: 정원 경합 처리(예: 비관적 락, 낙관적 락 + 재시도, 원자적 업데이트 중 1개 선택)
    - 세 버전에 대한 메소드 및 API 분리 구현 - 추후 F 단계 성능 테스트용
    - 비관적 락: `SELECT ... FOR UPDATE`
    - 낙관적 락: 버전 필드 + 재시도 로직
    - 원자적 업데이트: DB 레벨 `UPDATE ... WHERE enrolled < capacity` (내 예상)
  - 완료 기준(DoD):
    - 정원 1 강좌에 동시 100요청 시 성공 1건, 실패 99건
    - 최종 `enrolled <= capacity` 항상 만족
  - 리스크: 락 경합으로 성능 저하 또는 데드락
  - 대응: 락 범위 최소화, 타임아웃/재시도 정책 정의
  - 검증: 동시성 통합 테스트(멀티스레드)

- [x] D2. 동일 학생 동시 신청 충돌 처리
  - 우선순위: `P1`
  - 작업: 같은 학생이 동시에 여러 강좌 신청할 때 학점/시간표 규칙 일관성 보장
  - 완료 기준(DoD):
    - 경합 상황에서도 최종 학점 18 초과 불가
    - 충돌 시간표 동시 신청이 승인되지 않음
  - 리스크: read-then-write 레이스 조건
  - 대응: 학생 단위 락 또는 DB 무결성 + 재검증
  - 검증: 학생 단위 동시성 테스트

- [x] D3. 동시성 전략 문서화
  - 우선순위: `P0`
  - 작업: `docs/REQUIREMENTS.md`에 전략/근거/트레이드오프 기록
  - 완료 기준(DoD):
    - 사용한 락 메커니즘/격리수준 명시
    - 실패/재시도 정책 명시
  - 리스크: 구현과 문서 불일치
  - 대응: 구현 완료 후 문서 최종 동기화
  - 검증: 코드-문서 교차 리뷰

## E. 초기 데이터 생성

- [ ] E1. 동적 데이터 생성기 구현
  - 우선순위: `P0`
  - 작업: 애플리케이션 시작 시 프로그래밍 로직으로 데이터 생성
  - 완료 기준(DoD):
    - 정적 SQL/CSV 없이 런타임 생성
    - 재실행 가능한 시드 전략 제공(고정 seed 권장)
  - 리스크: 랜덤 데이터 중복/정합성 깨짐
  - 대응: 생성 규칙과 중복 방지 정책(유니크 키) 적용
  - 검증: 서버 재기동 후 데이터 검증

- [ ] E2. 최소 데이터 수량 충족
  - 우선순위: `P0`
  - 작업: 학과 10+, 강좌 500+, 학생 10,000+, 교수 100+ 생성
  - 완료 기준(DoD):
    - 각 엔티티 최소 수량 충족
    - 목록 API로 유효 ID 확인 가능
  - 리스크: 생성 성능 저하로 시작 시간 초과
  - 대응: 배치 insert/flush 간격 조정, 초기화 병목 제거
  - 검증: 카운트 조회 테스트

- [ ] E3. 현실적인 데이터 패턴 반영
  - 우선순위: `P1`
  - 작업: 학과명/강좌명/이름 토큰 기반 현실적 조합 생성
  - 완료 기준(DoD):
    - `User1`, `Course1` 형태 지양
    - 한국 대학 맥락의 식별 가능한 명명 패턴 적용
  - 리스크: 과도한 복잡도로 구현 지연
  - 대응: 소규모 토큰 사전 + 조합 규칙으로 단순화
  - 검증: 샘플 데이터 수동 점검

- [ ] E4. 1분 이내 초기화 보장
  - 우선순위: `P0`
  - 작업: 데이터 생성 + 애플리케이션 준비 완료를 60초 이내로 최적화
  - 완료 기준(DoD):
    - 콜드 스타트 기준 60초 이내 `/health` 200 응답
  - 리스크: JPA 개별 저장 반복으로 부팅 지연
  - 대응: 배치 전략, 불필요한 인덱스/검증 최소화
  - 검증: 기동 시간 측정 로그

## F. 동시성 제어 테스트

- 우선순위: `P2`
- [ ] CONCURRENCY_TEST_STRATEGE.md 참고

## G. 문서화 산출물

- [x] G1. API 명세 문서 작성
  - 우선순위: `P0`
  - 작업: `docs/` 내 API 문서(OpenAPI 또는 Markdown) 작성
  - 완료 기준(DoD):
    - 모든 엔드포인트 요청/응답/에러 케이스 정의
    - 테스트 가능한 요청/응답 예시 포함
  - 리스크: 실제 응답과 문서 불일치
  - 대응: API 테스트 결과 기준으로 문서 갱신
  - 검증: 문서 기반 수동 호출 검증

- [x] G2. README 작성/갱신
  - 우선순위: `P0`
  - 작업: 빌드/실행/접속 방법(포트 포함) 문서화
  - 완료 기준(DoD):
    - 처음 보는 평가자가 README만으로 서버 실행 가능
  - 리스크: 환경 의존 설정 누락
  - 대응: 필수 환경값, 기본값, 실행 예시 명시
  - 검증: README 절차 재실행

## H. 테스트 및 품질 검증

- [x] H1. 도메인 규칙 단위 테스트
  - 우선순위: `P0`
  - 작업: 정원/학점/시간충돌/중복신청 규칙 테스트
  - 완료 기준(DoD):
    - 핵심 규칙 각각 성공/실패 케이스 포함
  - 리스크: 경계값 누락
  - 대응: 17/18/19학점, 정원 0/1 경계값 케이스 포함
  - 검증: `./gradlew test --tests '*domain*'`

- [x] H2. API 통합 테스트
  - 우선순위: `P0`
  - 작업: 주요 엔드포인트 상태코드/응답 스키마 검증
  - 완료 기준(DoD):
    - 조회/신청/취소/시간표 API 통합 테스트 통과
  - 리스크: 테스트 데이터 의존으로 flaky 발생
  - 대응: 테스트 전용 데이터 픽스처 고정
  - 검증: `./gradlew test`

- [x] H3. 동시성 스트레스 테스트
  - 우선순위: `P0`
  - 작업: 멀티스레드 또는 병렬 요청으로 경합 검증
  - 완료 기준(DoD):
    - 동시 100요청 시 결과가 요구사항과 일치
    - 정원 초과 건수 0
  - 리스크: 테스트 자체가 레이스를 재현하지 못함
  - 대응: 시작 배리어/동시 시작 제어 도입
  - 검증: 동시성 전용 테스트 클래스 실행

- [x] H4. 성능/기동 시간 확인
  - 우선순위: `P1`
  - 작업: 초기화 시간 및 주요 API 응답시간 점검
  - 완료 기준(DoD):
    - 부팅+데이터 초기화 60초 이내
    - 목록/신청 API 응답 지연이 비정상적으로 크지 않음
  - 리스크: 로컬 환경 편차
  - 대응: 측정 조건(머신/옵션) 기록
  - 검증: 기동 로그, 간단 부하 테스트 결과
  - 실측(2026-02-08):
    - `Started CourseEnrollmentSystemApplication in 2.418 seconds`
    - `Initial data generation ... elapsedMs=625`
    - `GET /health` `200`, `time_total=0.068219s`
    - `GET /students?limit=5` `200`, `time_total=0.035376s`
    - `GET /courses?limit=5` `200`, `time_total=0.011840s`
    - `GET /professors?limit=5` `200`, `time_total=0.005930s`

## I. 제출물 최종 점검

- [ ] I1. 필수 파일 존재 확인
  - 우선순위: `P0`
  - 작업: 제출 구조 요건 충족 확인
  - 완료 기준(DoD):
    - `README.md`, `AGENTS.md`, `docs/REQUIREMENTS.md`, API 문서, `prompts/`, `src/` 존재
  - 리스크: 누락 파일로 감점
  - 대응: 제출 전 체크 스크립트 또는 수동 점검
  - 검증: `rg --files`로 파일 목록 확인

- [ ] I2. 평가 관점 자체 점검
  - 우선순위: `P0`
  - 작업: 동작 여부, 핵심 기능, 사고의 깊이 기준으로 자체 리뷰
  - 완료 기준(DoD):
    - 1단계(실행 가능) 충족
    - 2단계(핵심 규칙+동시성) 충족
    - 3단계(문서/테스트/AI 활용 이력) 충족
  - 리스크: 코드 구현 위주로 문서/프롬프트 누락
  - 대응: 체크리스트 기반 최종 리뷰 회차 운영
  - 검증: 최종 제출 리허설 1회

## 명시적 기본값(요구사항 공백 보완)

- [ ] 인증/인가 미구현: 과제 범위 밖으로 두고 ID 기반 요청 허용
- [ ] 이번 학기는 단일 학기로 가정
- [ ] 재수강/선수과목/학년 제한은 기본 미적용(문서에 미구현 사유 기록)
- [ ] 시간표 충돌은 같은 요일/시간 구간 겹침으로 판정
- [ ] 수강취소는 별도 기한 없이 허용(필요 시 추후 정책 확장)

## 권장 작업 순서

- [ ] 
  1) `A -> B -> C -> D -> E -> G -> F -> H -> I` 순서로 진행
- [ ] 2) `P0` 전부 완료 후 `P1`, `P2` 진행
- [ ] 3) 각 섹션 완료 즉시 문서(`REQUIREMENTS`, API 명세, README) 동기화
